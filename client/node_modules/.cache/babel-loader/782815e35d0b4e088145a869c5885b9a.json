{"ast":null,"code":"import _objectSpread from \"/home/uusi/front4/sipuliton/client/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/home/uusi/front4/sipuliton/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/uusi/front4/sipuliton/client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/uusi/front4/sipuliton/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/uusi/front4/sipuliton/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/uusi/front4/sipuliton/client/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/home/uusi/front4/sipuliton/client/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/home/uusi/front4/sipuliton/client/src/modules/app/components/NavigationBar.js\";\n\n/* In this file, is implementation of the navigation bar and implementation of\nmainmenu which opens from navigation bar.*/\nimport React from 'react';\nimport { Link, Redirect } from 'react-router-dom';\nimport { Navbar, NavbarToggler, Nav, NavLink, Button } from 'reactstrap';\nimport { Auth } from 'aws-amplify';\n/* Styles and icons */\n\nimport '../../../styles/navigationbar.css';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { Transition } from 'react-transition-group';\n/* Mainmenu components*/\n\nimport { LanguageSelection, MainMenu_ListItem, MainMenu_LogoutButton } from '../../mainmenu/index';\n/* Localization */\n\nimport LocalizedStrings from 'react-localization';\n\nvar NavigationBar =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(NavigationBar, _React$Component);\n\n  /* Constructor of the navication bar class. */\n  function NavigationBar(props) {\n    var _this;\n\n    _classCallCheck(this, NavigationBar);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(NavigationBar).call(this, props));\n    _this.state = {\n      visible: false,\n      userLogged: false,\n      admin: false,\n      restaurantOwner: false,\n      moderator: false,\n      language: 'fi',\n      redirectUrl: \"\",\n      languageChanged: false\n    };\n    _this.mainMenu = _this.mainMenu.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.home = _this.home.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.checkAccessRights = _this.checkAccessRights.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.changeLanguage = _this.changeLanguage.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n  /* Function which will be called when menu button is clicked. */\n\n\n  _createClass(NavigationBar, [{\n    key: \"mainMenu\",\n    value: function mainMenu() {\n      /* Sets menu visibility to visible or not visible. */\n      this.setState({\n        visible: !this.state.visible\n      });\n\n      if (this.state.visible) {\n        this.checkAccessRights();\n      }\n    }\n    /* Function which will be called when home button is clicked. */\n\n  }, {\n    key: \"home\",\n    value: function home() {\n      /* Closes menu, if menu is open */\n      if (this.state.visible === true) {\n        this.mainMenu();\n      }\n    }\n    /* This function checks logged in users rights. */\n\n  }, {\n    key: \"checkAccessRights\",\n    value: function checkAccessRights() {\n      var _this2 = this;\n\n      /* Get user information. */\n      Auth.currentAuthenticatedUser().then(function (user) {\n        /* Get current user group. */\n        var userGroup = user.signInUserSession.accessToken.payload[\"cognito:groups\"][0];\n\n        if (user != null) {\n          /* Check if user is logged in, after that set access to either register or login */\n          _this2.setState({\n            userLogged: true\n          });\n          /* Check if user is basic user, then restrict all accesses */\n\n\n          if (userGroup === \"SipulitonModUserGroup\") {\n            _this2.setState({\n              admin: false,\n              restaurantOwner: false,\n              moderator: false\n            });\n          }\n          /* Check if user has admin access, after that set access to admin pages */\n\n\n          if (userGroup === \"SipulitonAdminUserGroup\") {\n            _this2.setState({\n              admin: true\n            });\n          } else {\n            _this2.setState({\n              admin: false\n            });\n          }\n          /* Check if user is restaurant owner, after that set access to restaurant pages */\n\n\n          if (userGroup === 'SipulitonROUserGroup') {\n            _this2.setState({\n              restaurantOwner: true\n            });\n          } else {\n            _this2.setState({\n              restaurantOwner: false\n            });\n          }\n          /* Check if user has moderator access, after that set access to moderator pages */\n\n\n          if (userGroup === \"SipulitonModUserGroup\") {\n            _this2.setState({\n              moderator: true\n            });\n          } else {\n            _this2.setState({\n              moderator: false\n            });\n          }\n        } else {\n          _this2.setState({\n            userLogged: false\n          });\n        }\n      }).catch(function (err) {\n        /* If user is not logged in restrict accesses. */\n        _this2.setState({\n          userLogged: false,\n          admin: false,\n          restaurantOwner: false,\n          moderator: false\n        });\n      });\n    }\n  }, {\n    key: \"changeLanguage\",\n    value: function changeLanguage(language) {\n      var url = window.location.href;\n      url = url.replace(this.state.language, language);\n      var index = url.search('://');\n      url = url.slice(index + 3);\n      index = url.search('/');\n      url = url.slice(index);\n      console.log(url);\n      this.setState({\n        language: language,\n        redirectUrl: url,\n        languageChanged: true\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      /* Menu appearance styles. */\n      var duration = 0;\n      var transitionStyles = {\n        entering: {\n          opacity: 0,\n          'left': '-500px'\n        },\n        entered: {\n          opacity: 1,\n          'left': '0px'\n        },\n        exiting: {\n          opacity: 1,\n          'left': '0px'\n        },\n        exited: {\n          opacity: 0,\n          'left': '-500px'\n        }\n      };\n      /* Localization */\n\n      var strings = new LocalizedStrings({\n        en: {\n          mainmenu: \"Mainpage\",\n          map: \"Map\",\n          restaurantList: \"Restaurant list\",\n          restaurantManagement: \"Restaurant management\",\n          admin: \"Admin\",\n          moderation: \"Moderation\",\n          profile: \"Profile\",\n          login: \"Login\",\n          register: \"Register\",\n          logout: \"Logout\"\n        },\n        fi: {\n          mainmenu: \"Pääsivu\",\n          map: \"Kartta\",\n          restaurantList: \"Ravintola lista\",\n          restaurantManagement: \"Ravintola hallinta\",\n          admin: \"Admin\",\n          moderation: \"Moderointi\",\n          profile: \"Profiili\",\n          login: \"Kirjaudu\",\n          register: \"Rekisteröidy\",\n          logout: \"Kirjaudu ulos\"\n        }\n      });\n\n      if (this.state.language === \"fi\") {\n        strings.setLanguage('fi');\n      }\n\n      if (this.state.language === \"en\") {\n        strings.setLanguage('en');\n      }\n      /* URL Paths to pages*/\n\n\n      var pathToMenu = \"/\" + this.state.language;\n      var pathToMap = \"/\" + this.state.language + \"/map\";\n      var pathToRestaurantList = \"/\" + this.state.language + \"/restaurant_list\";\n      var pathToRestaurantManagement = \"/\" + this.state.language + \"/restaurant_management\";\n      var pathToAdmin = \"/\" + this.state.language + \"/admin\";\n      var pathToModerating = \"/\" + this.state.language + \"/moderating\";\n      var pathToProfile = \"/\" + this.state.language + \"/profile\";\n      var pathToLogin = \"/\" + this.state.language + \"/login\";\n      var pathToRegister = \"/\" + this.state.language + \"/register\";\n      /* Changed correct language to page after clicking change language. */\n\n      if (this.state.languageChanged) {\n        this.setState({\n          languageChanged: false\n        });\n        return React.createElement(Redirect, {\n          to: this.state.redirectUrl,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 201\n          },\n          __self: this\n        });\n      }\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 207\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 208\n        },\n        __self: this\n      }, React.createElement(Transition, {\n        in: this.state.visible,\n        out: !this.state.visible,\n        timeout: duration,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 209\n        },\n        __self: this\n      }, function (state) {\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 211\n          },\n          __self: this\n        }, React.createElement(Nav, {\n          vertical: true,\n          className: \"side-menu\",\n          onClick: _this3.mainMenu,\n          style: _objectSpread({}, transitionStyles[state]),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 212\n          },\n          __self: this\n        }, React.createElement(MainMenu_ListItem, {\n          path: pathToMenu,\n          text: strings.mainmenu,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 218\n          },\n          __self: this\n        }), React.createElement(MainMenu_ListItem, {\n          path: pathToMap,\n          text: strings.map,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 219\n          },\n          __self: this\n        }), React.createElement(MainMenu_ListItem, {\n          path: pathToRestaurantList,\n          text: strings.restaurantList,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 220\n          },\n          __self: this\n        }), _this3.state.restaurantOwner && React.createElement(MainMenu_ListItem, {\n          path: pathToRestaurantManagement,\n          text: strings.restaurantManagement,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 221\n          },\n          __self: this\n        }), _this3.state.admin && React.createElement(MainMenu_ListItem, {\n          path: pathToAdmin,\n          text: strings.admin,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 222\n          },\n          __self: this\n        }), _this3.state.moderator && React.createElement(MainMenu_ListItem, {\n          path: pathToModerating,\n          text: strings.moderation,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 223\n          },\n          __self: this\n        }), _this3.state.userLogged && React.createElement(MainMenu_ListItem, {\n          path: pathToProfile,\n          text: strings.profile,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 224\n          },\n          __self: this\n        }), !_this3.state.userLogged && React.createElement(MainMenu_ListItem, {\n          path: pathToLogin,\n          text: strings.login,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 225\n          },\n          __self: this\n        }), !_this3.state.userLogged && React.createElement(MainMenu_ListItem, {\n          path: pathToRegister,\n          text: strings.register,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 226\n          },\n          __self: this\n        }), _this3.state.userLogged && React.createElement(MainMenu_LogoutButton, {\n          redirectPath: pathToMenu,\n          logoutText: strings.logout,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 227\n          },\n          __self: this\n        }), React.createElement(\"li\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 228\n          },\n          __self: this\n        }, React.createElement(LanguageSelection, {\n          changeLanguage: _this3.changeLanguage,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 229\n          },\n          __self: this\n        }))));\n      })), React.createElement(Navbar, {\n        id: \"navBar\",\n        className: \"fixed-bottom bottom-bar\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 237\n        },\n        __self: this\n      }, React.createElement(NavbarToggler, {\n        onClick: this.mainMenu,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 238\n        },\n        __self: this\n      }, React.createElement(FontAwesomeIcon, {\n        size: \"2x\",\n        className: \"icon\",\n        icon: \"bars\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 239\n        },\n        __self: this\n      })), React.createElement(\"header\", {\n        className: \"header\",\n        style: {\n          'Align': 'center'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 241\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 242\n        },\n        __self: this\n      }, this.props.header_text)), React.createElement(NavLink, {\n        tag: Link,\n        to: pathToMenu,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 244\n        },\n        __self: this\n      }, React.createElement(FontAwesomeIcon, {\n        size: \"2x\",\n        className: \"icon\",\n        icon: \"home\",\n        onClick: this.home,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 245\n        },\n        __self: this\n      }))));\n    }\n  }]);\n\n  return NavigationBar;\n}(React.Component);\n\nexport default NavigationBar;","map":{"version":3,"sources":["/home/uusi/front4/sipuliton/client/src/modules/app/components/NavigationBar.js"],"names":["React","Link","Redirect","Navbar","NavbarToggler","Nav","NavLink","Button","Auth","FontAwesomeIcon","Transition","LanguageSelection","MainMenu_ListItem","MainMenu_LogoutButton","LocalizedStrings","NavigationBar","props","state","visible","userLogged","admin","restaurantOwner","moderator","language","redirectUrl","languageChanged","mainMenu","bind","home","checkAccessRights","changeLanguage","setState","currentAuthenticatedUser","then","user","userGroup","signInUserSession","accessToken","payload","catch","err","url","window","location","href","replace","index","search","slice","console","log","duration","transitionStyles","entering","opacity","entered","exiting","exited","strings","en","mainmenu","map","restaurantList","restaurantManagement","moderation","profile","login","register","logout","fi","setLanguage","pathToMenu","pathToMap","pathToRestaurantList","pathToRestaurantManagement","pathToAdmin","pathToModerating","pathToProfile","pathToLogin","pathToRegister","header_text","Component"],"mappings":"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","sourcesContent":["/* In this file, is implementation of the navigation bar and implementation of\nmainmenu which opens from navigation bar.*/\n\nimport React from 'react';\nimport { Link, Redirect } from 'react-router-dom';\nimport {\n  Navbar,\n  NavbarToggler,\n  Nav,\n  NavLink,\n  Button\n} from 'reactstrap';\nimport { Auth } from 'aws-amplify';\n\n/* Styles and icons */\nimport '../../../styles/navigationbar.css';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { Transition } from 'react-transition-group';\n\n/* Mainmenu components*/\nimport { LanguageSelection, MainMenu_ListItem, MainMenu_LogoutButton } from '../../mainmenu/index';\n\n/* Localization */\nimport LocalizedStrings from 'react-localization';\n\n\nclass NavigationBar extends React.Component {\n\n  /* Constructor of the navication bar class. */\n  constructor(props) {\n    super(props);\n    this.state = {\n      visible: false,\n      userLogged: false,\n      admin: false,\n      restaurantOwner:false,\n      moderator: false,\n      language:'fi',\n      redirectUrl:\"\",\n      languageChanged:false\n    };\n\n    this.mainMenu = this.mainMenu.bind(this);\n    this.home = this.home.bind(this);\n    this.checkAccessRights = this.checkAccessRights.bind(this);\n    this.changeLanguage = this.changeLanguage.bind(this);\n  }\n\n  /* Function which will be called when menu button is clicked. */\n  mainMenu() {\n      /* Sets menu visibility to visible or not visible. */\n      this.setState({ visible: !this.state.visible});\n      if(this.state.visible){\n        this.checkAccessRights();\n      }\n  }\n\n  /* Function which will be called when home button is clicked. */\n  home() {\n    /* Closes menu, if menu is open */\n    if(this.state.visible === true){\n      this.mainMenu();\n    }\n  }\n\n  /* This function checks logged in users rights. */\n  checkAccessRights() {\n    /* Get user information. */\n    Auth.currentAuthenticatedUser()\n        .then(user => {\n          /* Get current user group. */\n          var userGroup = user.signInUserSession.accessToken.payload[\"cognito:groups\"][0];\n          if(user != null){\n            /* Check if user is logged in, after that set access to either register or login */\n            this.setState({userLogged: true})\n\n            /* Check if user is basic user, then restrict all accesses */\n            if(userGroup === \"SipulitonModUserGroup\"){\n              this.setState({\n                admin: false,\n                restaurantOwner: false,\n                moderator: false\n              })\n            }\n\n            /* Check if user has admin access, after that set access to admin pages */\n            if(userGroup === \"SipulitonAdminUserGroup\"){\n              this.setState({admin: true})\n            }\n            else{\n              this.setState({admin: false})\n            }\n            /* Check if user is restaurant owner, after that set access to restaurant pages */\n\n            if(userGroup === 'SipulitonROUserGroup'){\n              this.setState({restaurantOwner: true})\n            }\n            else{\n              this.setState({restaurantOwner: false})\n            }\n\n            /* Check if user has moderator access, after that set access to moderator pages */\n            if(userGroup === \"SipulitonModUserGroup\"){\n              this.setState({moderator: true})\n            }\n            else{\n              this.setState({moderator: false})\n            }\n\n          }\n          else{\n              this.setState({userLogged: false})\n          }\n\n        })\n        .catch(err => {\n          /* If user is not logged in restrict accesses. */\n          this.setState(\n            {\n              userLogged: false,\n              admin: false,\n              restaurantOwner:false,\n              moderator: false\n            }\n          )\n        });\n\n  }\n\n  changeLanguage(language) {\n    var url = window.location.href;\n    url = url.replace(this.state.language, language);\n    var index = url.search('://');\n    url = url.slice(index + 3);\n    index = url.search('/');\n    url = url.slice(index);\n    console.log(url);\n    this.setState({language: language, redirectUrl: url, languageChanged: true});\n  }\n\n  render() {\n      /* Menu appearance styles. */\n      const duration = 0;\n      const transitionStyles = {\n        entering: { opacity: 0, 'left':'-500px' },\n        entered:  { opacity: 1, 'left':'0px' },\n        exiting: { opacity: 1, 'left':'0px' },\n        exited: { opacity: 0, 'left':'-500px' }\n      };\n\n      /* Localization */\n      let strings = new LocalizedStrings({\n        en:{\n          mainmenu:\"Mainpage\",\n          map:\"Map\",\n          restaurantList:\"Restaurant list\",\n          restaurantManagement:\"Restaurant management\",\n          admin:\"Admin\",\n          moderation:\"Moderation\",\n          profile:\"Profile\",\n          login:\"Login\",\n          register:\"Register\",\n          logout: \"Logout\"\n        },\n        fi: {\n          mainmenu:\"Pääsivu\",\n          map:\"Kartta\",\n          restaurantList:\"Ravintola lista\",\n          restaurantManagement:\"Ravintola hallinta\",\n          admin:\"Admin\",\n          moderation:\"Moderointi\",\n          profile:\"Profiili\",\n          login:\"Kirjaudu\",\n          register:\"Rekisteröidy\",\n          logout:\"Kirjaudu ulos\"\n        }\n      });\n\n      if(this.state.language === \"fi\"){\n        strings.setLanguage('fi');\n      }\n      if(this.state.language === \"en\"){\n        strings.setLanguage('en');\n      }\n\n      /* URL Paths to pages*/\n      const pathToMenu = \"/\" + this.state.language;\n      const pathToMap = \"/\" + this.state.language+\"/map\";\n      const pathToRestaurantList = \"/\" + this.state.language + \"/restaurant_list\";\n      const pathToRestaurantManagement = \"/\" + this.state.language + \"/restaurant_management\";\n      const pathToAdmin = \"/\" + this.state.language + \"/admin\";\n      const pathToModerating = \"/\" + this.state.language + \"/moderating\";\n      const pathToProfile = \"/\" + this.state.language + \"/profile\";\n      const pathToLogin = \"/\" + this.state.language + \"/login\";\n      const pathToRegister = \"/\" + this.state.language + \"/register\";\n\n      /* Changed correct language to page after clicking change language. */\n      if(this.state.languageChanged){\n        this.setState({languageChanged:false});\n        return(\n          <Redirect to={this.state.redirectUrl}/>\n        );\n      }\n\n      return (\n\n        <div>\n          <div>\n            <Transition in={this.state.visible} out={!this.state.visible} timeout={duration}>\n              {(state) => (\n                <div>\n                  <Nav \n                    vertical\n                    className=\"side-menu\" \n                    onClick={this.mainMenu} \n                    style={{...transitionStyles[state]}}\n                  >\n                    <MainMenu_ListItem path={pathToMenu} text={strings.mainmenu} />\n                    <MainMenu_ListItem path={pathToMap} text={strings.map} />\n                    <MainMenu_ListItem path={pathToRestaurantList} text={strings.restaurantList} />\n                    {this.state.restaurantOwner && <MainMenu_ListItem path={pathToRestaurantManagement} text={strings.restaurantManagement} />}\n                    {this.state.admin && <MainMenu_ListItem path={pathToAdmin} text={strings.admin} />}\n                    {this.state.moderator && <MainMenu_ListItem path={pathToModerating} text={strings.moderation} />}\n                    {this.state.userLogged && <MainMenu_ListItem path={pathToProfile} text={strings.profile} />}\n                    {!this.state.userLogged && <MainMenu_ListItem path={pathToLogin} text={strings.login} />}\n                    {!this.state.userLogged && <MainMenu_ListItem path={pathToRegister} text={strings.register} />}\n                    {this.state.userLogged && <MainMenu_LogoutButton redirectPath={pathToMenu} logoutText={strings.logout}/>}\n                    <li>\n                      <LanguageSelection changeLanguage={this.changeLanguage} />\n                    </li>\n                  </Nav>\n                </div>\n              )}\n            </Transition>\n          </div>\n\n          <Navbar id=\"navBar\" className=\"fixed-bottom bottom-bar\">\n            <NavbarToggler onClick={this.mainMenu}>\n              <FontAwesomeIcon size=\"2x\" className=\"icon\" icon=\"bars\"/>\n            </NavbarToggler>\n            <header className=\"header\" style={{'Align':'center'}}>\n              <h1>{this.props.header_text}</h1>\n            </header>\n            <NavLink tag={Link} to={pathToMenu}>\n              <FontAwesomeIcon size=\"2x\" className=\"icon\" icon=\"home\" onClick={this.home}/>\n            </NavLink>\n          </Navbar>\n        </div>\n\n      );\n    }\n}\n\n\nexport default NavigationBar;\n"]},"metadata":{},"sourceType":"module"}